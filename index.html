<!DOCTYPE html>
<html class="h-100">
<head>
    <title>Omok Online</title>

    <link href="https://unpkg.com/bootstrap@4.1.0/dist/css/bootstrap.min.css" type="text/css" rel="stylesheet" />
    <link href="styles/main.css" type="text/css" rel="stylesheet" />
</head>
<body class="h-100">

    <div id="app" class="h-100">
        <div style="display: none;" v-show="true" class="h-100">
            <div class="container h-100">
                <div class="row h-100">
                    <div id="game-panel" class="col-12 col-md-8 col-lg-9 h-100">

                    </div>
                    <div id="setup-panel" class="col-12 col-md-4 col-lg-3 h-100">
                        <div v-if="$data.isConnected" class="d-flex h-100 flex-column">
                            <div>
                                <div class="input-group input-group-sm mt-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="inputGroup-sizing-sm">Game ID</span>
                                    </div>
                                    <input type="text" class="form-control" v-model="$data.gameId" disabled />
                                </div>
                                <div class="mt-1 small">
                                    <a @click.prevent="$data.helpers.copyGameLink" v-bind:href="$data.helpers.getGameLink()" class="text-decoration-none">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-clipboard" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z" />
                                            <path fill-rule="evenodd" d="M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z" />
                                        </svg>
                                        <span>{{ $data.copyGameLinkText }}</span>
                                    </a>
                                </div>
                            </div>
                            <div class="mt-3">
                                <div v-if="$data.gameState.started">
                                    <button type="button" class="btn btn-outline-danger btn-block">Forfeit</button>
                                </div>
                                <div v-else-if="$data.isHost">
                                    <button type="button" class="btn btn-outline-primary btn-block" @click="$data.events.startGame" v-bind:disabled="!$data.computed.allReady()">Start</button>
                                </div>
                                <div v-else>
                                    <button type="button" class="btn btn-outline-primary btn-block" v-show="!$data.player.isReady" @click="$data.events.toggleReady">Ready</button>
                                    <button type="button" class="btn btn-warning btn-block" v-show="$data.player.isReady" @click="$data.events.toggleReady">Un-Ready</button>
                                </div>
                            </div>
                            <div class="mt-3 mb-3 d-flex flex-column" style="flex: 1; min-height: 0;">
                                <div class="chat__box" style="flex: 1; min-height: 0;" id="chat-box">
                                    <div v-for="message in $data.messages" v-bind:title="message.created" class="chat__message">
                                        <template v-for="player in [$data.helpers.getPlayer(message.playerId)]">
                                            <span v-if="player.name" :style="{ 'color': player.color }" class="chat__message-name">{{ player.name }}</span>
                                            <span class="chat__message-message" :style="{ 'color': message.color }">{{ message.message }}</span>
                                        </template>
                                    </div>
                                </div>
                                <form @submit.prevent="$data.helpers.submitMyMessage" class="mt-1">
                                    <div class="input-group">
                                        <input type="text" class="form-control" v-model="$data.myMessage">
                                        <div class="input-group-append">
                                            <button class="btn btn-outline-secondary" type="submit">Send</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div v-else-if="$data.isConnecting">
                            <div style="white-space: pre-wrap;">{{ $data.connectionStatus }}</div>
                        </div>
                        <div v-else>
                            <form id="name-form" @submit.prevent>
                                <div class="input-group input-group-sm mt-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="inputGroup-sizing-sm">Name</span>
                                    </div>
                                    <input type="text" class="form-control" v-model="$data.player.name" maxlength="24" required v-focus />
                                </div>
                            </form>

                            <hr />

                            <form @submit.prevent="$data.helpers.joinGame">
                                <div class="input-group input-group-sm mt-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="inputGroup-sizing-sm">Game ID</span>
                                    </div>
                                    <input type="text" class="form-control" v-model="$data.gameId" required />
                                </div>

                                <button type="submit" class="btn btn-outline-primary btn-block mt-3">Join Game</button>
                            </form>

                            <hr />

                            <form @submit.prevent="$data.helpers.createGame">
                                <button type="submit" class="btn btn-outline-secondary btn-block mt-3">Create Game</button>
                            </form>

                        </div>
                    </div>
                </div>
            </div>

            <div class="connection__status" v-show="$data.connectionStatus.length > 0">
                Status: {{ $data.connectionStatus }}
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/lodash@4.17.20/lodash.min.js"></script>
    <script src="https://unpkg.com/vue@3.0.0/dist/vue.global.js"></script>
    <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
    <script src="https://unpkg.com/randomcolor@0.6.2/randomColor.js"></script>
    <script src="https://unpkg.com/chance@1.1.7/dist/chance.min.js"></script>

    <script src="scripts/vue.directives.js"></script>

    <script src="scripts/helpers.js"></script>
    <script src="scripts/main.js"></script>
</body>
</html>